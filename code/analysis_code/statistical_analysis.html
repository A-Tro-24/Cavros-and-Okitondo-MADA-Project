<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chris Okitondo and Irene Cavros">
<meta name="dcterms.date" content="2023-03-13">

<title>Model Fitting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="statistical_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="statistical_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="statistical_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="statistical_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="statistical_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="statistical_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="statistical_analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="statistical_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="statistical_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="statistical_analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Model Fitting</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Chris Okitondo and Irene Cavros </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 13, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>In this section, we will undergo the following two tasks:</p>
<ul>
<li><p>Fit various bivariate logistic models to the categorical outcome (taking the flu vaccine) with individual important predictors of interest.</p></li>
<li><p>Fit logistic models to the categorical outcome (taking the flu vaccine) using all (important) predictors of interest.</p></li>
</ul>
<section id="setup" class="level3">
<h3 class="anchored" data-anchor-id="setup">Setup</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load needed packages. make sure they are installed.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co">#for data loading/saving</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">Load data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Path to data. </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_location <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"processed_data"</span>,<span class="st">"processeddata.rds"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#load data</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(data_location)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="view-data" class="level3">
<h3 class="anchored" data-anchor-id="view-data">View data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="take-another-quick-look-at-the-data" class="level3">
<h3 class="anchored" data-anchor-id="take-another-quick-look-at-the-data">Take another quick look at the data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 792,916
Columns: 29
$ YEAR                  &lt;dbl&gt; 2012, 2012, 2012, 2012, 2012, 2012, 2012, 2012, …
$ SERIAL                &lt;dbl&gt; 1, 1, 2, 3, 5, 5, 6, 6, 7, 8, 8, 8, 8, 9, 10, 10…
$ STRATA                &lt;dbl&gt; 6109, 6109, 6167, 6042, 6117, 6117, 6035, 6035, …
$ PSU                   &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, …
$ NHISHID               &lt;chr&gt; "00002012000001", "00002012000001", "00002012000…
$ NHISPID               &lt;chr&gt; "0020120000010101", "0020120000010102", "0020120…
$ age                   &lt;dbl&gt; 45, 44, 79, 64, 45, 47, 22, 25, 64, 55, 46, 15, …
$ sex                   &lt;fct&gt; female, male, female, female, female, male, male…
$ race                  &lt;fct&gt; white, white, white, white, white, white, white,…
$ hispanic              &lt;fct&gt; non-hispanic, non-hispanic, non-hispanic, non-hi…
$ veteran_status        &lt;fct&gt; non-veteran, non-veteran, non-veteran, non-veter…
$ education             &lt;fct&gt; some_college, less_than_hs, high_school, graduat…
$ employ_status         &lt;fct&gt; retired, employed, retired, retired, retired, em…
$ paid_sick             &lt;fct&gt; NA, no, NA, yes, yes, NA, NA, no, yes, NA, NA, N…
$ fam_income            &lt;fct&gt; "&lt; $50,000", "&lt; $50,000", "&lt; $50,000", "$50,000-…
$ pov_ratio             &lt;chr&gt; "14", "14", "22", "37", "37", "37", "34", "34", …
$ health_status         &lt;fct&gt; poor, excellent, fair, very_good, fair, very_goo…
$ bmi                   &lt;fct&gt; NA, obese, NA, obese, overweight, NA, NA, averag…
$ med_access            &lt;fct&gt; NA, no, NA, yes, yes, NA, NA, yes, yes, NA, NA, …
$ med_care_delayed_cost &lt;fct&gt; no, yes, no, no, no, no, yes, no, no, no, no, no…
$ health_ins_status     &lt;fct&gt; yes, no, yes, yes, yes, yes, yes, yes, yes, yes,…
$ flu_vaccine           &lt;fct&gt; NA, no, NA, no, no, NA, NA, yes, yes, NA, NA, no…
$ asthma                &lt;fct&gt; NA, no, NA, no, yes, NA, NA, no, yes, NA, NA, no…
$ cancer                &lt;fct&gt; NA, no, NA, no, no, NA, NA, no, no, NA, NA, NA, …
$ chd                   &lt;fct&gt; NA, no, NA, no, no, NA, NA, no, no, NA, NA, NA, …
$ alcohol_status        &lt;fct&gt; NA, drinker, NA, former_drinker, drinker, NA, NA…
$ smoking_status        &lt;fct&gt; 0, smoker, 0, nonsmoker, nonsmoker, 0, 0, nonsmo…
$ worry_freq            &lt;fct&gt; NA, NA, NA, NA, daily, NA, NA, NA, never, NA, NA…
$ dep_freq              &lt;fct&gt; NA, NA, NA, NA, never, NA, NA, NA, weekly, NA, N…</code></pre>
</div>
</div>
</section>
<section id="ensure-we-are-ignoring-the-na-values-in-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="ensure-we-are-ignoring-the-na-values-in-the-dataset">Ensure we are ignoring the NA values in the dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mydata2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-variable-names" class="level3">
<h3 class="anchored" data-anchor-id="check-variable-names">Check variable names</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mydata2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "YEAR"                  "SERIAL"                "STRATA"               
 [4] "PSU"                   "NHISHID"               "NHISPID"              
 [7] "age"                   "sex"                   "race"                 
[10] "hispanic"              "veteran_status"        "education"            
[13] "employ_status"         "paid_sick"             "fam_income"           
[16] "pov_ratio"             "health_status"         "bmi"                  
[19] "med_access"            "med_care_delayed_cost" "health_ins_status"    
[22] "flu_vaccine"           "asthma"                "cancer"               
[25] "chd"                   "alcohol_status"        "smoking_status"       
[28] "worry_freq"            "dep_freq"             </code></pre>
</div>
</div>
</section>
<section id="convert-scientific-notation-into-decimals" class="level3">
<h3 class="anchored" data-anchor-id="convert-scientific-notation-into-decimals">Convert scientific notation into decimals</h3>
<p><em>This will help us more easily determine which variables are significant.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-up-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="set-up-logistic-regression">Set up logistic regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>log_mod <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fitting-bivariate-logistic-models" class="level1">
<h1>Fitting bivariate logistic models</h1>
<section id="using-flu-uptake-as-the-outcome-and-age-as-predictor" class="level3">
<h3 class="anchored" data-anchor-id="using-flu-uptake-as-the-outcome-and-age-as-predictor">Using flu uptake as the outcome and age as predictor</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>log_fit_age <span class="ot">&lt;-</span> log_mod <span class="sc">%&gt;%</span> <span class="fu">fit</span>(<span class="fu">as.factor</span>(flu_vaccine) <span class="sc">~</span> age, <span class="at">data =</span> mydata2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(log_fit_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)  -1.81    0.0199       -90.7       0
2 age           0.0326  0.000377      86.5       0</code></pre>
</div>
</div>
</section>
<section id="using-flu-uptake-as-the-outcome-and-sex-as-predictor" class="level3">
<h3 class="anchored" data-anchor-id="using-flu-uptake-as-the-outcome-and-sex-as-predictor">Using flu uptake as the outcome and sex as predictor</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>log_fit_sex <span class="ot">&lt;-</span> log_mod <span class="sc">%&gt;%</span> <span class="fu">fit</span>(<span class="fu">as.factor</span>(flu_vaccine) <span class="sc">~</span> sex, <span class="at">data =</span> mydata2)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(log_fit_sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   -0.357   0.00902     -39.6 0        
2 sexfemale      0.326   0.0123       26.4 2.93e-153</code></pre>
</div>
</div>
</section>
<section id="using-flu-uptake-as-the-outcome-and-race-as-predictor" class="level3">
<h3 class="anchored" data-anchor-id="using-flu-uptake-as-the-outcome-and-race-as-predictor">Using flu uptake as the outcome and race as predictor</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>log_fit_race <span class="ot">&lt;-</span> log_mod <span class="sc">%&gt;%</span> <span class="fu">fit</span>(<span class="fu">as.factor</span>(flu_vaccine) <span class="sc">~</span> race, <span class="at">data =</span> mydata2)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(log_fit_race)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term                estimate std.error statistic   p.value
  &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)          -0.146    0.00682    -21.4  7.14e-102
2 raceblack            -0.350    0.0190     -18.4  2.94e- 75
3 racenative american  -0.113    0.0601      -1.89 5.93e-  2
4 raceasian             0.0955   0.0269       3.55 3.79e-  4</code></pre>
</div>
</div>
<p><em>This shows that the black population and Native Americans are less likely to take the flu vaccine compared to white people. However, asians are more likely to take the flu vaccine compared to whites.</em></p>
</section>
<section id="using-flu-uptake-as-the-outcome-and-education-as-predictor" class="level3">
<h3 class="anchored" data-anchor-id="using-flu-uptake-as-the-outcome-and-education-as-predictor">Using flu uptake as the outcome and education as predictor</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>log_fit_education <span class="ot">&lt;-</span> log_mod <span class="sc">%&gt;%</span> <span class="fu">fit</span>(<span class="fu">as.factor</span>(flu_vaccine) <span class="sc">~</span> education, <span class="at">data =</span> mydata2)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(log_fit_education)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term                  estimate std.error statistic   p.value
  &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)            -0.404     0.0192   -21.1   1.58e- 98
2 educationhigh_school    0.0107    0.0231     0.463 6.43e-  1
3 educationsome_college   0.0998    0.0222     4.50  6.71e-  6
4 educationbachelor       0.368     0.0233    15.8   4.38e- 56
5 educationgraduate       0.799     0.0257    31.0   1.37e-211</code></pre>
</div>
</div>
<p><em>This results show that the higher the degree someone has, the more likely they are to take the flu vaccine.</em></p>
</section>
<section id="using-flu-uptake-as-outcome-and-family-income-as-predictor" class="level3">
<h3 class="anchored" data-anchor-id="using-flu-uptake-as-outcome-and-family-income-as-predictor">Using flu uptake as outcome and family income as predictor</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>log_fit_fam_income <span class="ot">&lt;-</span> log_mod <span class="sc">%&gt;%</span> <span class="fu">fit</span>(<span class="fu">as.factor</span>(flu_vaccine) <span class="sc">~</span> fam_income, <span class="at">data =</span> mydata2)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(log_fit_fam_income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term                      estimate std.error statistic   p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)                 -0.352   0.00911     -38.6 0        
2 fam_income$50,000-$99,999    0.168   0.0146       11.5 1.05e- 30
3 fam_income$100,000+          0.479   0.0154       31.1 3.11e-212</code></pre>
</div>
</div>
<p><em>The results show that the higher their income, the greater the likelihood for someone to take the flu vaccine.</em></p>
</section>
<section id="using-flu-uptake-as-outcome-and-health-insurance-status-as-predictor" class="level3">
<h3 class="anchored" data-anchor-id="using-flu-uptake-as-outcome-and-health-insurance-status-as-predictor">Using flu uptake as outcome and health insurance status as predictor</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>log_fit_health_ins <span class="ot">&lt;-</span> log_mod <span class="sc">%&gt;%</span> <span class="fu">fit</span>(<span class="fu">as.factor</span>(flu_vaccine) <span class="sc">~</span> health_ins_status, <span class="at">data =</span> mydata2)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(log_fit_health_ins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term                 estimate std.error statistic p.value
  &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)             -1.67    0.0252     -66.3       0
2 health_ins_statusyes     1.63    0.0260      62.7       0</code></pre>
</div>
</div>
<p><em>Those with insurance coverage are more likely to take the flu vaccine.</em></p>
</section>
<section id="using-flu-uptake-as-outcome-and-medical-care-access-as-predictor" class="level3">
<h3 class="anchored" data-anchor-id="using-flu-uptake-as-outcome-and-medical-care-access-as-predictor">Using flu uptake as outcome and medical care access as predictor</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>log_fit_medical_care <span class="ot">&lt;-</span> log_mod <span class="sc">%&gt;%</span> <span class="fu">fit</span>(<span class="fu">as.factor</span>(flu_vaccine) <span class="sc">~</span> med_access, <span class="at">data =</span> mydata2)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(log_fit_medical_care)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term          estimate std.error statistic p.value
  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)      -1.47    0.0220     -66.7       0
2 med_accessyes     1.44    0.0229      62.7       0</code></pre>
</div>
</div>
<p><em>If they have at least one usual place to seek medical care, they are more likely to take the flu vaccine.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mydata2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "YEAR"                  "SERIAL"                "STRATA"               
 [4] "PSU"                   "NHISHID"               "NHISPID"              
 [7] "age"                   "sex"                   "race"                 
[10] "hispanic"              "veteran_status"        "education"            
[13] "employ_status"         "paid_sick"             "fam_income"           
[16] "pov_ratio"             "health_status"         "bmi"                  
[19] "med_access"            "med_care_delayed_cost" "health_ins_status"    
[22] "flu_vaccine"           "asthma"                "cancer"               
[25] "chd"                   "alcohol_status"        "smoking_status"       
[28] "worry_freq"            "dep_freq"             </code></pre>
</div>
</div>
</section>
</section>
<section id="fitting-multivariate-logistic-models" class="level1">
<h1>Fitting multivariate logistic models</h1>
<section id="categorical-outcome-as-flu-vaccine-with-some-demographic-variables-as-predictors-of-interest" class="level3">
<h3 class="anchored" data-anchor-id="categorical-outcome-as-flu-vaccine-with-some-demographic-variables-as-predictors-of-interest">Categorical outcome as flu vaccine with some demographic variables as predictors of interest</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>log_fit_dems <span class="ot">&lt;-</span> log_mod <span class="sc">%&gt;%</span> <span class="fu">fit</span>(<span class="fu">as.factor</span>(flu_vaccine) <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> race <span class="sc">+</span> hispanic <span class="sc">+</span> education <span class="sc">+</span> fam_income, <span class="at">data =</span> mydata2)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>dems_model <span class="ot">&lt;-</span> <span class="fu">tidy</span>(log_fit_dems)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>dems_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 5
   term                      estimate std.error statistic   p.value
   &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)               -2.41     0.0334     -72.2   0        
 2 age                        0.0343   0.000397    86.4   0        
 3 sexfemale                  0.355    0.0131      27.1   5.37e-162
 4 raceblack                 -0.241    0.0204     -11.8   3.62e- 32
 5 racenative american        0.231    0.0633       3.66  2.57e-  4
 6 raceasian                  0.115    0.0285       4.04  5.43e-  5
 7 hispanichispanic          -0.178    0.0210      -8.48  2.24e- 17
 8 educationhigh_school       0.00425  0.0249       0.170 8.65e-  1
 9 educationsome_college      0.185    0.0245       7.56  4.12e- 14
10 educationbachelor          0.424    0.0266      16.0   2.82e- 57
11 educationgraduate          0.702    0.0294      23.9   8.98e-126
12 fam_income$50,000-$99,999  0.132    0.0160       8.26  1.40e- 16
13 fam_income$100,000+        0.353    0.0180      19.6   7.58e- 86</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(dems_model, <span class="at">file =</span> (<span class="fu">here</span>(<span class="st">"results"</span>, <span class="st">"demographics_model.rds"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="categorical-outcome-as-flu-vaccine-with-asthma-cancer-and-chd-as-predictors-of-interest" class="level3">
<h3 class="anchored" data-anchor-id="categorical-outcome-as-flu-vaccine-with-asthma-cancer-and-chd-as-predictors-of-interest">Categorical outcome as flu vaccine with asthma, cancer, and CHD as predictors of interest</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>log_fit_medical_cond <span class="ot">&lt;-</span> log_mod <span class="sc">%&gt;%</span> <span class="fu">fit</span>(<span class="fu">as.factor</span>(flu_vaccine) <span class="sc">~</span>  asthma<span class="sc">+</span> chd <span class="sc">+</span> cancer, <span class="at">data =</span> mydata2)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(log_fit_medical_cond)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   -0.336   0.00707     -47.5 0        
2 asthmayes      0.242   0.0183       13.2 4.53e- 40
3 chdyes         0.856   0.0306       28.0 5.67e-172
4 canceryes      0.792   0.0215       36.9 1.09e-297</code></pre>
</div>
</div>
</section>
<section id="categorical-outcome-as-flu-vaccine-with-smoking-and-alcohol-status-as-predictors-of-interest" class="level3">
<h3 class="anchored" data-anchor-id="categorical-outcome-as-flu-vaccine-with-smoking-and-alcohol-status-as-predictors-of-interest">Categorical outcome as flu vaccine with smoking and alcohol status as predictors of interest</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>log_fit_health_behaviors <span class="ot">&lt;-</span> log_mod <span class="sc">%&gt;%</span> <span class="fu">fit</span>(<span class="fu">as.factor</span>(flu_vaccine) <span class="sc">~</span>  smoking_status<span class="sc">+</span> alcohol_status, <span class="at">data =</span> mydata2)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(log_fit_health_behaviors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term                         estimate std.error statistic   p.value
  &lt;chr&gt;                           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)                   -0.164     0.0156    -10.5  1.20e- 25
2 smoking_statusformer_smoker    0.279     0.0151     18.4  9.33e- 76
3 smoking_statussmoker          -0.584     0.0184    -31.8  5.73e-222
4 alcohol_statusformer_drinker   0.217     0.0228      9.49 2.31e- 21
5 alcohol_statusdrinker         -0.0465    0.0175     -2.65 8.03e-  3</code></pre>
</div>
</div>
<p><em>This results show that former smokers and former drinkers are more likely to get the flu vaccine compared to the population who never smoked or drank. The active smokers are less likely to take the vaccine compared to those who do not drink. There was no statistical difference between the active drinkers and those who do not drink in terms of their vaccine uptake.</em></p>
</section>
<section id="categorical-outcome-as-flu-vaccine-with-smoking-and-alcohol-as-predictors-of-interest" class="level3">
<h3 class="anchored" data-anchor-id="categorical-outcome-as-flu-vaccine-with-smoking-and-alcohol-as-predictors-of-interest">Categorical outcome as flu vaccine with smoking and alcohol as predictors of interest</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>log_fit_full <span class="ot">&lt;-</span> log_mod <span class="sc">%&gt;%</span> <span class="fu">fit</span>(<span class="fu">as.factor</span>(flu_vaccine) <span class="sc">~</span>  age <span class="sc">+</span> sex <span class="sc">+</span> race <span class="sc">+</span> hispanic <span class="sc">+</span> education <span class="sc">+</span> fam_income <span class="sc">+</span> asthma <span class="sc">+</span> cancer <span class="sc">+</span> chd <span class="sc">+</span> smoking_status<span class="sc">+</span> alcohol_status, <span class="at">data =</span> mydata2)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>table_full <span class="ot">&lt;-</span> <span class="fu">tidy</span>(log_fit_full)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>table_full</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 5
   term                         estimate std.error statistic   p.value
   &lt;chr&gt;                           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)                  -2.24     0.0379     -59.0   0        
 2 age                           0.0307   0.000433    70.8   0        
 3 sexfemale                     0.348    0.0134      26.0   5.50e-149
 4 raceblack                    -0.236    0.0207     -11.4   3.35e- 30
 5 racenative american           0.250    0.0637       3.92  8.72e-  5
 6 raceasian                     0.132    0.0289       4.58  4.73e-  6
 7 hispanichispanic             -0.192    0.0213      -9.05  1.49e- 19
 8 educationhigh_school          0.00483  0.0253       0.191 8.48e-  1
 9 educationsome_college         0.159    0.0249       6.36  2.06e- 10
10 educationbachelor             0.379    0.0273      13.9   6.99e- 44
11 educationgraduate             0.647    0.0301      21.5   2.10e-102
12 fam_income$50,000-$99,999     0.131    0.0162       8.05  8.02e- 16
13 fam_income$100,000+           0.348    0.0183      19.0   2.09e- 80
14 asthmayes                     0.335    0.0193      17.3   3.03e- 67
15 canceryes                     0.279    0.0231      12.1   9.92e- 34
16 chdyes                        0.493    0.0325      15.2   4.74e- 52
17 smoking_statusformer_smoker   0.0569   0.0166       3.43  6.11e-  4
18 smoking_statussmoker         -0.401    0.0199     -20.2   2.54e- 90
19 alcohol_statusformer_drinker  0.0579   0.0243       2.38  1.72e-  2
20 alcohol_statusdrinker        -0.0221   0.0196      -1.13  2.57e-  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(table_full, <span class="at">file =</span> (<span class="fu">here</span>(<span class="st">"results"</span>, <span class="st">"full_model.rds"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>The results show that those who graduated from high school did not statistically differ from those who never graduated for their flu vaccine uptake. Also, current drinkers did not statically differ from those who never drank. All other predictors were found statistically significant.</em></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>